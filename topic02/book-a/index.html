 <!DOCTYPE html>
 <html>
   <head>

     <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">

     <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet" type="text/css">
     <link href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/solarized_light.min.css" rel="stylesheet" />

     <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
     <script type="text/javascript" src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
     <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>
     <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/languages/java.min.js"></script>
     <script>hljs.initHighlightingOnLoad();</script>

      <style>


body 
{
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
}

figcaption
{
  margin-bottom: 20px;
}

.vertical-align
{
  display: flex;
  align-items: center;
}

.credits
{
  min-height:20px;
}
    </style>

  </head>

  <body>

    <div class="container">
<style>


code
{
  font-family: "Monaco";
  font-size: 110%;
}

img
{
  padding:1px;
  border:1px solid black;
}

h1
{
  font-style:italic;
  font-size:130%;
  border-bottom: thin solid black;
}
h2
{
  font-size:110%;
  border-bottom: thin solid black;
}
h3
{
  font-size:100%;
  border-bottom: thin solid black;
}

</style>

<div class="navbar navbar-default navbar-inverse navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <a type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a>
      <div class="navbar-brand">
        <a onclick="window.history.back()" href="#"> <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> </a>
        2: Events & Models
      </div>
    </div>
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="active"><a href= "#Donation-02" data-toggle="tab"> Donation-02 </a> </li>
          <li><a href= "#01" data-toggle="tab"> 01 </a> </li>
          <li><a href= "#02" data-toggle="tab"> 02 </a> </li>
          <li><a href= "#03" data-toggle="tab"> 03 </a> </li>
          <li><a href= "#04" data-toggle="tab"> 04 </a> </li>
          <li><a href= "#05" data-toggle="tab"> 05 </a> </li>
          <li><a href= "#06" data-toggle="tab"> 06 </a> </li>
          <li><a href= "#07" data-toggle="tab"> 07 </a> </li>
          <li><a href= "#08" data-toggle="tab"> 08 </a> </li>
          <li><a href= "#09" data-toggle="tab"> 09 </a> </li>
          <li><a href= "#10" data-toggle="tab"> 10 </a> </li>
          <li><a href= "#11" data-toggle="tab"> 11 </a> </li>
          <li><a href= "#Exercises" data-toggle="tab"> Exercises </a> </li>
      </ul>
    </div>
  </div>
</div>

<br><br>

<div class="tab-content">
  <div class="tab-pane active" id="Donation-02">
    <h1>Objectives</h1>
<p>Introduce a second screen to display the list of donations made by the user. In addition, enable our app its first "Model" objects, which will be used to store the individual donations made by the user. </p>
  </div>

    <div class="tab-pane fade" id="01">
      <h1>Donation-01 Solutions</h1>
<p>In this lab we shall all work on the NUC platform. </p>
<ul>
<li>
<p>At the end of the lab you will commit and push your work to your Bitbucket accounts and download it into your personal computers.</p>
</li>
<li>
<p>In the Donation-01 lab you created a repository <em>donation-android-2015</em>. Save this to a secure location. </p>
</li>
<li>
<p>In this lab we shall provide a model solution to the lab (named <em>donation-android-2015</em>) so that we will all begin this Donation-02 with exactly the same code base. There already exists a folder in the NUC named repo. Many of you may have been developing here. Therefore it is important to avoid name clashes. If a folder named <em>donation-android-2015</em> already exists in <em>repo</em>, either rename it, delete it or move it to a subfolder within repo.</p>
</li>
<li>
<p>You create a folder with the mkdir command:</p>
</li>
</ul>
<pre><code>mkdir &lt;new folder&gt;
</code></pre>

<p>For example:</p>
<pre><code>mkdir backup-projects
</code></pre>

<p>You may remove a folder and all its contents with this (dangerous) command:</p>
<pre><code>rm -rf &lt;folder name&gt;
</code></pre>

<p>You may also move a folder. For example to move a folder named folder1 into a folder2:</p>
<pre><code>mv folder 1 folder2/
</code></pre>

<p>Note: do not omit the / at the end of, for example, folder2.</p>
<p>All passwords are ictskills.</p>
<p>You may move a folder as follows. For example, move <em>donation-android-2015</em> to a backup-projects folder which is also in repo:</p>
<pre><code>mv donation-android-2015 backup-projects/
</code></pre>

<p>When you ready, download <em>donation-android-2015</em> from GitHub as follows:</p>
<pre><code>git clone https://github.com/usplitu/donation-android-2015.git
</code></pre>

<ul>
<li>GitHub is an alternative repository hosting company to BitBucket.</li>
<li>In this instance neither a password nor an ssh key is required as the project is public.</li>
<li>When you have downloaded the project, change into its root directory:</li>
</ul>
<pre><code>cd donation-android-2015
</code></pre>

<ul>
<li>Check the commits: use your customized log command (gitp). An example is shown here.
<img alt="" src="img/12.png"></li>
<li>Check the tags: (git tag -n).<ul>
<li>There aren't any.</li>
</ul>
</li>
<li>Build on this repository, making appropriate commits and tags, as you progress through this and subsequent Donation labs.<ul>
<li>You may wish to apply a tag at the end of each lab, for example, v1, v2, v3...</li>
<li>Notice that in the downloaded project, all steps that involve code changes are committed separately. This has the advantage of being able to easily roll back to the beginning of the current step within a lab in the event that insurmountable difficulties arise.</li>
</ul>
</li>
<li>Launch Android Studio and open this project.<ul>
<li>If the project is not present in the Recent Projects panel, open the project as shown in Figure 1:</li>
</ul>
</li>
</ul>
<p><img alt="Figure 1: Open and existing Android Studio project" src="img/10.png"></p>
<p>You may be presented with a message as shown in Figure 2 indicating an unregistered version control system (VCS).</p>
<ul>
<li>Click <strong>Add root</strong>.</li>
</ul>
<p><img alt="Figure 2: Configure git VCS" src="img/11.png"></p>
<p>Once you have opened the project in Android Studio you are ready to proceed with the lab, the first part of which is to provide solutions to the exercises at the end of Donation-01.</p>
    </div>
    <div class="tab-pane fade" id="02">
      <h1>Donation-01 Solution Exercise 2</h1>
<p>We are now in a position to address the exercises presented at the end of Donation-01, excluding Exercise 1. We are skipping Exercise 1 Solution because you have already gained considerable experience in the use of git during the summer school and because we shall be providing instructions on committing and pushing the code developed in this lab.</p>
<h2>Exercise 2:</h2>
<p>Consider an alternative to the NumberPicker - specifically one of the "Text Fields" controls:</p>
<p><img alt="Figure 1: Textfields" src="img/25.png"></p>
<p>These are mostly EditView objects:</p>
<ul>
<li><a href="http://developer.android.com/reference/android/widget/EditText.html">http://developer.android.com/reference/android/widget/EditText.html</a></li>
</ul>
<p>Redesign the activity to take a value from the picker or directly from a text view:</p>
<p><img alt="Figure 2: Textview alternative number input" src="img/26.png"></p>
<p>If the number picker is set to zero, then attempt to get a number from the text view.</p>
<p>Here is a hint (a version of donatButonPressed that does what we want):</p>
<pre><code class="java">  public void donateButtonPressed (View view) 
  {
    String method = paymentMethod.getCheckedRadioButtonId() == R.id.PayPal ? &quot;PayPal&quot; : &quot;Direct&quot;;
    progressBar.setProgress(totalDonated);

    int donatedAmount =  amountPicker.getValue();
    if (donatedAmount == 0)
    {
      String text = amountText.getText().toString();
      if (!text.equals(&quot;&quot;))
        donatedAmount = Integer.parseInt(text);
    }
    totalDonated  = totalDonated + donatedAmount;
    Log.v(&quot;Donate&quot;, amountPicker.getValue() + &quot; donated by &quot; +  method + &quot;\nCurrent total &quot; + totalDonated);
   }
</code></pre>

<h2>Exercise 2 Solution</h2>
<p>Here is the refactored layout file:</p>
<pre><code>&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
                xmlns:tools=&quot;http://schemas.android.com/tools&quot;
                android:layout_width=&quot;match_parent&quot;
                android:layout_height=&quot;match_parent&quot;
                android:paddingBottom=&quot;@dimen/activity_vertical_margin&quot;
                android:paddingLeft=&quot;@dimen/activity_horizontal_margin&quot;
                android:paddingRight=&quot;@dimen/activity_horizontal_margin&quot;
                android:paddingTop=&quot;@dimen/activity_vertical_margin&quot;
                tools:context=&quot;.Donate&quot; &gt;

  &lt;TextView
      android:id=&quot;@+id/donateTitle&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_alignParentLeft=&quot;true&quot;
      android:layout_alignParentRight=&quot;true&quot;
      android:layout_alignParentTop=&quot;true&quot;
      android:text=&quot;@string/donateTitle&quot;
      android:textAppearance=&quot;?android:attr/textAppearanceLarge&quot; /&gt;

  &lt;TextView
      android:id=&quot;@+id/donateSubtitle&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_alignParentLeft=&quot;true&quot;
      android:layout_alignParentRight=&quot;true&quot;
      android:layout_below=&quot;@+id/donateTitle&quot;
      android:text=&quot;@string/donateSubtitle&quot;
      android:textAppearance=&quot;?android:attr/textAppearanceMedium&quot; /&gt;

  &lt;RadioGroup
      android:id=&quot;@+id/paymentMethod&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_above=&quot;@+id/progressBar&quot;
      android:layout_alignLeft=&quot;@+id/donateSubtitle&quot;
      android:layout_below=&quot;@+id/donateSubtitle&quot;
      android:layout_marginLeft=&quot;14dp&quot;
      android:layout_marginTop=&quot;26dp&quot;
      android:layout_toLeftOf=&quot;@+id/amountPicker&quot; &gt;

    &lt;RadioButton
        android:id=&quot;@+id/PayPal&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:checked=&quot;true&quot;
        android:text=&quot;@string/PayPal&quot; /&gt;

    &lt;RadioButton
        android:id=&quot;@+id/Direct&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:text=&quot;@string/Direct&quot; /&gt;

  &lt;/RadioGroup&gt;

  &lt;ProgressBar
      android:id=&quot;@+id/progressBar&quot;
      style=&quot;?android:attr/progressBarStyleHorizontal&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_above=&quot;@+id/donateButton&quot;
      android:layout_alignParentLeft=&quot;true&quot;
      android:layout_alignParentRight=&quot;true&quot;
      android:layout_marginBottom=&quot;67dp&quot; /&gt;

  &lt;NumberPicker
      android:id=&quot;@+id/amountPicker&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_alignRight=&quot;@+id/donateSubtitle&quot;
      android:layout_alignTop=&quot;@+id/paymentMethod&quot; /&gt;

  &lt;EditText
      android:id=&quot;@+id/amountText&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_above=&quot;@+id/donateButton&quot;
      android:layout_alignParentRight=&quot;true&quot;
      android:layout_marginBottom=&quot;20dp&quot;
      android:ems=&quot;10&quot;
      android:inputType=&quot;number&quot; &gt;
    &lt;requestFocus /&gt;
  &lt;/EditText&gt;

  &lt;TextView
      android:id=&quot;@+id/amountLabel&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_alignBottom=&quot;@+id/amountText&quot;
      android:layout_alignLeft=&quot;@+id/paymentMethod&quot;
      android:labelFor=&quot;@id/amountText&quot;
      android:text=&quot;@string/amount&quot;
      android:textAppearance=&quot;?android:attr/textAppearanceMedium&quot; /&gt;

  &lt;Button
      android:id=&quot;@+id/donateButton&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_alignParentBottom=&quot;true&quot;
      android:layout_alignParentLeft=&quot;true&quot;
      android:layout_marginBottom=&quot;15dp&quot;
      android:onClick=&quot;donateButtonPressed&quot;
      android:text=&quot;@string/donateButton&quot; /&gt;

  &lt;TextView
      android:id=&quot;@+id/amountTotal&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_alignBottom=&quot;@+id/donateButton&quot;
      android:layout_alignRight=&quot;@+id/amountText&quot;
      android:text=&quot;@string/initialAmount&quot;
      android:textAppearance=&quot;?android:attr/textAppearanceMedium&quot; /&gt;

  &lt;TextView
      android:id=&quot;@+id/totalLabel&quot;
      android:layout_width=&quot;wrap_content&quot;
      android:layout_height=&quot;wrap_content&quot;
      android:layout_alignBaseline=&quot;@+id/amountTotal&quot;
      android:layout_alignBottom=&quot;@+id/amountTotal&quot;
      android:layout_toLeftOf=&quot;@+id/amountPicker&quot;
      android:text=&quot;@string/amountSoFarLabel&quot;
      android:textAppearance=&quot;?android:attr/textAppearanceMedium&quot; /&gt;

&lt;/RelativeLayout&gt;
</code></pre>

<p>Here is the refactored Donation activity file:</p>
<ul>
<li>Note that output is written to logcat.</li>
</ul>
<pre><code>package com.example.donation;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RadioGroup;
import android.widget.NumberPicker;
import android.widget.ProgressBar;
import android.widget.TextView;

public class Donate extends AppCompatActivity
{

  private Button       donateButton;
  private RadioGroup   paymentMethod;
  private ProgressBar  progressBar;
  private NumberPicker amountPicker;
  private int          totalDonated;

  private TextView     amountText;
  private TextView     amountTotal;

  @Override
  protected void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_donate);

    donateButton  = (Button) findViewById(R.id.donateButton);
    paymentMethod = (RadioGroup)   findViewById(R.id.paymentMethod);
    progressBar   = (ProgressBar)  findViewById(R.id.progressBar);
    amountPicker  = (NumberPicker) findViewById(R.id.amountPicker);

    amountText    = (EditText)     findViewById(R.id.amountText);

    amountPicker.setMinValue(0);
    amountPicker.setMaxValue(1000);
    progressBar.setMax(10000);

    totalDonated = 0;

  }

  @Override
  public boolean onCreateOptionsMenu(Menu menu)
  {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.menu_donate, menu);
    return true;
  }


  public void donateButtonPressed (View view)
  {
    String method = paymentMethod.getCheckedRadioButtonId() == R.id.PayPal ? &quot;PayPal&quot; : &quot;Direct&quot;;
    progressBar.setProgress(totalDonated);

    int donatedAmount =  amountPicker.getValue();
    if (donatedAmount == 0)
    {
      String text = amountText.getText().toString();
      if (!text.equals(&quot;&quot;))
        donatedAmount = Integer.parseInt(text);
    }
    totalDonated  = totalDonated + donatedAmount;
    Log.v(&quot;Donate&quot;, amountPicker.getValue() + &quot; donated by &quot; + method + &quot;\nCurrent total &quot; + totalDonated);
  }

  @Override
  public boolean onOptionsItemSelected(MenuItem item)
  {
    // Handle action bar item clicks here. The action bar will
    // automatically handle clicks on the Home/Up button, so long
    // as you specify a parent activity in AndroidManifest.xml.
    int id = item.getItemId();

    //noinspection SimplifiableIfStatement
    if (id == R.id.action_settings)
    {
      return true;
    }

    return super.onOptionsItemSelected(item);
  }
}

</code></pre>
    </div>
    <div class="tab-pane fade" id="03">
      <h1>Donation-01 Solution Exercise 3</h1>
<h2>Exercise 3:</h2>
<p>Revise the app such that when the target is achieved (10000) - then no more donations accepted, and the user is made aware of this.</p>
<p>Hint - here is how you can display a simple alert:</p>
<pre><code class="java">      Toast toast = Toast.makeText(this, &quot;Target Exceeded!&quot;, Toast.LENGTH_SHORT);
      toast.show();
</code></pre>

<h2>Exercise 3 Solution</h2>
<p>Here is the refactored Donation activity:</p>
<pre><code>package com.example.donation;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RadioGroup;
import android.widget.NumberPicker;
import android.widget.ProgressBar;
import android.widget.TextView;
import android.widget.Toast;

public class Donate extends AppCompatActivity
{

  private Button       donateButton;
  private RadioGroup   paymentMethod;
  private ProgressBar  progressBar;
  private NumberPicker amountPicker;
  private int          totalDonated;
  private int          target;

  private TextView     amountText;
  private TextView     amountTotal;

  @Override
  protected void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_donate);

    donateButton  = (Button) findViewById(R.id.donateButton);
    paymentMethod = (RadioGroup)   findViewById(R.id.paymentMethod);
    progressBar   = (ProgressBar)  findViewById(R.id.progressBar);
    amountPicker  = (NumberPicker) findViewById(R.id.amountPicker);
    amountTotal   = (TextView)     findViewById(R.id.amountTotal);
    amountText    = (EditText)     findViewById(R.id.amountText);

    amountPicker.setMinValue(0);
    amountPicker.setMaxValue(1000);
    progressBar.setMax(10000);

    totalDonated = 0;
    target = 10000;

  }

  @Override
  public boolean onCreateOptionsMenu(Menu menu)
  {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.menu_donate, menu);
    return true;
  }


  public void donateButtonPressed (View view)
  {
    if (totalDonated &gt;= target)
    {
      Toast toast = Toast.makeText(this, &quot;Target Exceeded!&quot;, Toast.LENGTH_SHORT);
      toast.show();
      Log.v(&quot;Donate&quot;,&quot;Target Exceeded: &quot; + totalDonated);
      return;
    }
    String method = paymentMethod.getCheckedRadioButtonId() == R.id.PayPal ? &quot;PayPal&quot; : &quot;Direct&quot;;
    int donatedAmount = amountPicker.getValue();
    if (donatedAmount == 0)
    {
      String text = amountText.getText().toString();
      if (!text.equals(&quot;&quot;))
      {
        totalDonated += Integer.parseInt(text);
      }
    }
    else
    {
      totalDonated = totalDonated + donatedAmount;
    }
    Log.v(&quot;Donate&quot;, donatedAmount + &quot; donated by &quot; + method + &quot; Current total &quot; + totalDonated);
    progressBar.setProgress(totalDonated);

  }

  @Override
  public boolean onOptionsItemSelected(MenuItem item)
  {
    // Handle action bar item clicks here. The action bar will
    // automatically handle clicks on the Home/Up button, so long
    // as you specify a parent activity in AndroidManifest.xml.
    int id = item.getItemId();

    //noinspection SimplifiableIfStatement
    if (id == R.id.action_settings)
    {
      return true;
    }

    return super.onOptionsItemSelected(item);
  }
}


</code></pre>
    </div>
    <div class="tab-pane fade" id="04">
      <h1>Donation-01 Solution Exercise 4</h1>
<h2>Exercise 4:</h2>
<p>Show on screen at all times the total amount donated.</p>
<p>You will use standard TextView for this:</p>
<ul>
<li><a href="http://developer.android.com/reference/android/widget/TextView.html">http://developer.android.com/reference/android/widget/TextView.html</a></li>
</ul>
<p>You already have a number of these on screen. Your layout could be revised to look like this:</p>
<p><img alt="Figure 3: Total so far displayed" src="img/27.png"></p>
<h2>Exercise 4 Solution</h2>
<p>Here is the refactored Donation activity;</p>
<pre><code>package com.example.donation;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RadioGroup;
import android.widget.NumberPicker;
import android.widget.ProgressBar;
import android.widget.TextView;
import android.widget.Toast;

public class Donate extends AppCompatActivity
{

  private Button       donateButton;
  private RadioGroup   paymentMethod;
  private ProgressBar  progressBar;
  private NumberPicker amountPicker;
  private int          totalDonated;
  private int          target;

  private TextView     amountText;
  private TextView     amountTotal;

  @Override
  protected void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_donate);

    donateButton  = (Button) findViewById(R.id.donateButton);
    paymentMethod = (RadioGroup)   findViewById(R.id.paymentMethod);
    progressBar   = (ProgressBar)  findViewById(R.id.progressBar);
    amountPicker  = (NumberPicker) findViewById(R.id.amountPicker);
    amountTotal   = (TextView)     findViewById(R.id.amountTotal);
    amountText    = (EditText)     findViewById(R.id.amountText);

    amountPicker.setMinValue(0);
    amountPicker.setMaxValue(1000);
    progressBar.setMax(10000);

    totalDonated = 0;
    target = 10000;

  }

  @Override
  public boolean onCreateOptionsMenu(Menu menu)
  {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.menu_donate, menu);
    return true;
  }


  public void donateButtonPressed (View view)
  {
    if (totalDonated &gt;= target)
    {
      Toast toast = Toast.makeText(this, &quot;Target Exceeded!&quot;, Toast.LENGTH_SHORT);
      toast.show();
      Log.v(&quot;Donate&quot;,&quot;Target Exceeded: &quot; + totalDonated);
      return;
    }
    String method = paymentMethod.getCheckedRadioButtonId() == R.id.PayPal ? &quot;PayPal&quot; : &quot;Direct&quot;;
    int donatedAmount = amountPicker.getValue();
    if (donatedAmount == 0)
    {
      String text = amountText.getText().toString();
      if (!text.equals(&quot;&quot;))
      {
        totalDonated += Integer.parseInt(text);
      }
    }
    else
    {
      totalDonated = totalDonated + donatedAmount;
    }
    Log.v(&quot;Donate&quot;, donatedAmount + &quot; donated by &quot; + method + &quot; Current total &quot; + totalDonated);
    progressBar.setProgress(totalDonated);

    String totalDonatedStr = &quot;$&quot; + totalDonated;
    amountTotal.setText(totalDonatedStr);
  }

  @Override
  public boolean onOptionsItemSelected(MenuItem item)
  {
    // Handle action bar item clicks here. The action bar will
    // automatically handle clicks on the Home/Up button, so long
    // as you specify a parent activity in AndroidManifest.xml.
    int id = item.getItemId();

    //noinspection SimplifiableIfStatement
    if (id == R.id.action_settings)
    {
      return true;
    }

    return super.onOptionsItemSelected(item);
  }
}

</code></pre>
    </div>
    <div class="tab-pane fade" id="05">
      <h1>Package Name</h1>
<p>This version is a little misconfigured - we have a leftover - the package name 'com.example.donation' form the project generation wizard.<br> 
This can be changed as follows:</p>
<ul>
<li>With the project imported to Android Studio, select Project in the Project Structure pane.</li>
<li>Expand the folders in <em>src</em> to reveal <em>com.example.donation</em> packages in both <em>androidTest</em> and <em>main</em>.
<img alt="Figure 1: Project Structure pane" src="img/20.png"></li>
<li>Create a new package <em>app.donation</em> in <em>androidTest/java</em>.<ul>
<li>Drag the file <em>ApplicationTest</em> to this new package.</li>
</ul>
</li>
<li>Create a new package <em>app.activities</em> in <em>main/java</em>.<ul>
<li>Drag file <em>Donate</em> to this new package.</li>
</ul>
</li>
<li>Both original packages, <em>com.example.donation</em> should be deleted automatically without user intervention.
<img alt="Figure 2: Create new packages and populate by drag and drop" src="img/21.png"></li>
<li>Change the package name to <em>app.donation</em> in <em>AndroidManifest.xml</em>.
<img alt="Figure 3: Update AndroidManifest.xml" src="img/24.png"></li>
<li>Change <em>applicationID</em> to <em>app.donation</em> in build.gradle.<ul>
<li>Sync Now if prompted.
<img alt="Figure 4: Update build.gradle" src="img/22.png"></li>
</ul>
</li>
<li>Check that the import statement in <em>Donate.java</em> is as follows:<ul>
<li><em>import app.donation.R;</em></li>
</ul>
</li>
<li>Clean the project.
<img alt="Figure 5: Clean project" src="img/23.png"></li>
<li>Test by rebuilding (Build | Rebuild) and running (Run | Run 'app').</li>
</ul>
<p>Here is the revised structure:
<img alt="Figure 6: Revised structure" src="img/25.png"></p>
    </div>
    <div class="tab-pane fade" id="06">
      <h1>Menu</h1>
<p>Open <code>res/values/Strings.xml</code> and introduce a new String resource like this:</p>
<pre><code class="xml">    &lt;string name=&quot;menuReport&quot;&gt;Report&lt;/string&gt;
</code></pre>

<p>We have a menu resource called 'menu_donate.xml' in the <code>res/menu</code> folder. Modify this file by adding this new menu item:</p>
<pre><code>    &lt;item
        android:id=&quot;@+id/menuReport&quot;
        android:orderInCategory=&quot;100&quot;
        android:title=&quot;@string/menuReport&quot;    /&gt;

</code></pre>

<p>In Donate.java, change the <code>onOptionsItemSelected</code> method to look like this:</p>
<pre><code class="java">    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {
        switch (item.getItemId())
        {
            case R.id.menuReport:
                Toast toast = Toast.makeText(this, &quot;Report Selected&quot;, Toast.LENGTH_SHORT);
                toast.show();
                break;
        }
        return true;
    }
</code></pre>

<p>Run the app and when you press the menu button (or the overflow menu) and select 'Report', you should see the toast message appear.</p>
<p><img alt="" src="img/05.png"></p>
    </div>
    <div class="tab-pane fade" id="07">
      <h1>Reports Activity</h1>
<p>Design a new layout called Report defined within a file named activity_report.xml located in res/layout - to look something like this:</p>
<p><img alt="Figure 1: Report activity design view" src="img/01.png"></p>
<p>This is the layout file itself:</p>
<pre><code class="xml">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:paddingBottom=&quot;@dimen/activity_vertical_margin&quot;
    android:paddingLeft=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingRight=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingTop=&quot;@dimen/activity_vertical_margin&quot;
    tools:context=&quot;.Test&quot; &gt;

    &lt;TextView
        android:id=&quot;@+id/reportTitle&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignParentLeft=&quot;true&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:layout_alignParentTop=&quot;true&quot;
        android:text=&quot;@string/reportTitle&quot;
        android:textAppearance=&quot;?android:attr/textAppearanceLarge&quot; /&gt;

    &lt;ListView
        android:id=&quot;@+id/reportList&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignLeft=&quot;@+id/reportTitle&quot;
        android:layout_below=&quot;@+id/reportTitle&quot; &gt;

    &lt;/ListView&gt;

&lt;/RelativeLayout&gt;
</code></pre>

<p>Add a string resource:</p>
<pre><code>&lt;string name=&quot;reportTitle&quot;&gt;Report&lt;/string&gt;
</code></pre>

<p>Introduce a new Class into app.activities to render this activity:</p>
<pre><code class="java">package app.activities;

import app.donation.R;
import app.main.DonationApp;
import android.app.Activity;
import android.os.Bundle;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class Report extends Activity
{
  ListView listView;

  static final String[] numbers = new String[] { 
      &quot;Amount, Pay method&quot;,
      &quot;10,     Direct&quot;,
      &quot;100,    PayPal&quot;,
      &quot;1000,   Direct&quot;,
      &quot;10,     PayPal&quot;,
      &quot;5000,   PayPal&quot;};

  @Override
  public void onCreate(Bundle savedInstanceState) 
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_report);

    listView = (ListView) findViewById(R.id.reportList);
    ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,  android.R.layout.simple_list_item_1, numbers); 
    listView.setAdapter(adapter);
  }
} 
</code></pre>

<p>This will display a hard-coded lists of donations.</p>
<p>Change Donate activity to load this view when 'Report' selected from menu:</p>
<pre><code class="java">  @Override
  public boolean onOptionsItemSelected(MenuItem item)
  {
    switch (item.getItemId())
    {
      case R.id.menuReport : startActivity (new Intent(this, Report.class));
                             break;
    }
    return true;
  }
</code></pre>

<p>This requires an import statement:</p>
<pre><code>import android.content.Intent;
</code></pre>

<p>All of this will not work until you add the activity specification to the AndroidManifest.xml file:</p>
<pre><code class="xml">        &lt;activity
            android:name=&quot;app.activities.Report&quot;
            android:label=&quot;@string/donateTitle&quot; &gt;
        &lt;/activity&gt;
</code></pre>

<p>Try it all now - it should load. Here is an example using the inbuilt emulator (AVD).</p>
<p><img alt="Figure 2: Report rendered on Android AVD" src="img/06.png"></p>
    </div>
    <div class="tab-pane fade" id="08">
      <h1>Application Object</h1>
<p>In order to keep out application design coherent, we now bring in an 'Application' object.</p>
<p>Create a new package called 'app.main'. Expand the empty middle packages before doing so and compact them when you have added the new class <em>DonationApp</em> described below. See Figure 1.</p>
<p><img alt="Figure 1: How to expand and compact empty middle packages" src="img/07.png"></p>
<p>Incorporate this class here:</p>
<pre><code class="java">package app.main;

import android.app.Application;
import android.util.Log;

public class DonationApp extends Application
{
  @Override
  public void onCreate()
  {
    super.onCreate();
    Log.v(&quot;Donation&quot;, &quot;Donation App Started&quot;);
  }
}
</code></pre>

<p>Application objects need to be references in the AndroidManifest.xml - at the very top as 'android:name':</p>
<p>Add this attribute to the application element:</p>
<pre><code>android:name=&quot;app.main.DonationApp&quot;
</code></pre>

<p>This now becomes:</p>
<pre><code class="xml">    &lt;application
        android:allowBackup=&quot;true&quot;
        android:icon=&quot;@mipmap/ic_launcher&quot;
        android:label=&quot;@string/app_name&quot;
        android:theme=&quot;@style/AppTheme&quot;
        android:name=&quot;app.main.DonationApp&quot;&gt;
</code></pre>

<p>Your project should now look like this:</p>
<p><img alt="Figure 2: Project Structure" src="img/03.png"></p>
<p>Make sure the 'Donation App Started' appears in the logs to verify that it has actually been engaged correctly as demonstrated in Figure 3.</p>
<p><img alt="Figure 3: Logcat window" src="img/08.png"></p>
    </div>
    <div class="tab-pane fade" id="09">
      <h1>Donation Model</h1>
<p>Create a new package called 'models' and bring in this class here:</p>
<pre><code class="java">package app.models;

public class Donation
{
  public int    amount;
  public String method;

  public Donation (int amount, String method)
  {
    this.amount = amount;
    this.method = method;
  }
}
</code></pre>

<p>This is a revised version of DonationApp - which now manages a list of donations. It also centralises the 'makeDonation' event implementing it as a method. Replace your version with this one:</p>
<pre><code class="java">package app.main;

import java.util.ArrayList;
import java.util.List;

import android.app.Application;
import android.util.Log;
import android.widget.Toast;
import app.models.Donation;

public class DonationApp extends Application
{
  public final int       target       = 10000;
  public int             totalDonated = 0;
  public List &lt;Donation&gt; donations    = new ArrayList&lt;Donation&gt;();

  public boolean newDonation(Donation donation)
  {
    boolean targetAchieved = totalDonated &gt; target;
    if (!targetAchieved)
    {
      donations.add(donation);
      totalDonated += donation.amount;
    }
    else
    {
      Toast toast = Toast.makeText(this, &quot;Target Exceeded!&quot;, Toast.LENGTH_SHORT);
      toast.show();
    }
    return targetAchieved;
  }

  @Override
  public void onCreate()
  {
    super.onCreate();
    Log.v(&quot;Donation&quot;, &quot;Donation App Started&quot;);
  }
}
</code></pre>
    </div>
    <div class="tab-pane fade" id="10">
      <h1>Refactored Donate</h1>
<p>The Donate activity can now be completely re factored to make use of the DonationApp object.</p>
<pre><code class="java">package app.activities;

import app.donation.R;
import app.main.DonationApp;
import app.models.Donation;
import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.RadioGroup;
import android.widget.NumberPicker;
import android.widget.ProgressBar;
import android.widget.TextView;

public class Donate extends Activity
{
  private RadioGroup   paymentMethod;
  private ProgressBar  progressBar;
  private NumberPicker amountPicker;
  private TextView     amountText;
  private TextView     amountTotal;
  private DonationApp app;

  @Override
  protected void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_donate);

    app = (DonationApp) getApplication();

    paymentMethod = (RadioGroup)   findViewById(R.id.paymentMethod);
    progressBar   = (ProgressBar)  findViewById(R.id.progressBar);
    amountPicker  = (NumberPicker) findViewById(R.id.amountPicker);
    amountText    = (TextView)     findViewById(R.id.amountText);
    amountTotal   = (TextView)     findViewById(R.id.amountTotal);

    amountPicker.setMinValue(0);
    amountPicker.setMaxValue(1000);
    progressBar.setMax(app.target);
  }

  @Override
  public boolean onCreateOptionsMenu(Menu menu)
  {
    getMenuInflater().inflate(R.menu.menu_donate, menu);
    return true;
  }

  @Override
  public boolean onOptionsItemSelected(MenuItem item)
  {
    switch (item.getItemId())
    {
      case R.id.menuReport : startActivity (new Intent(this, Report.class));
                             break;
    }
    return true;
  }

  public void donateButtonPressed (View view) 
  {
    String method = paymentMethod.getCheckedRadioButtonId() == R.id.PayPal ? &quot;PayPal&quot; : &quot;Direct&quot;;
    int donatedAmount =  amountPicker.getValue();
    if (donatedAmount == 0)
    {
      String text = amountText.getText().toString();
      if (!text.equals(&quot;&quot;))
        donatedAmount = Integer.parseInt(text);
    }
    if (donatedAmount &gt; 0)
    {
      app.newDonation(new Donation(donatedAmount, method));
      progressBar.setProgress(app.totalDonated);
      String totalDonatedStr = &quot;$&quot; + app.totalDonated;
      amountTotal.setText(totalDonatedStr);
    }
   }
}
</code></pre>

<p>Replace your version with this and execute it.</p>
<p>Look carefully at the changes to this version over the v1 attempt.</p>
    </div>
    <div class="tab-pane fade" id="11">
      <h1>Refactored Report</h1>
<p>We now rework Report to render the actual donations - held in the DonationApp list.</p>
<p>First some layout additions. Include these new string in strings.xml</p>
<pre><code>    &lt;string name=&quot;defaultAmount&quot;&gt;00&lt;/string&gt;
    &lt;string name=&quot;defaultMethod&quot;&gt;N/A&lt;/string&gt;
</code></pre>

<p>This is a new layout - to be called 'row_donate.xml'. Place this in the 'layout' folder.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot; &gt;

    &lt;TextView
        android:id=&quot;@+id/row_amount&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignParentLeft=&quot;true&quot;
        android:layout_alignParentTop=&quot;true&quot;
        android:layout_marginLeft=&quot;48dp&quot;
        android:layout_marginTop=&quot;20dp&quot;
        android:text=&quot;@string/defaultAmount&quot; /&gt;

    &lt;TextView
        android:id=&quot;@+id/row_method&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignBaseline=&quot;@+id/row_amount&quot;
        android:layout_alignBottom=&quot;@+id/row_amount&quot;
        android:layout_marginLeft=&quot;106dp&quot;
        android:layout_toRightOf=&quot;@+id/row_amount&quot;
        android:text=&quot;@string/defaultMethod&quot; /&gt;

&lt;/RelativeLayout&gt;
</code></pre>

<p>Finally, rework Report class to remove the hard coded values - and use a different 'adapter'</p>
<pre><code class="java">package app.activities;

import java.util.List;
import app.donation.R;
import app.main.DonationApp;
import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;
import app.models.Donation;

public class Report extends Activity
{
  private ListView    listView;
  private DonationApp app;

  @Override
  public void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_report);

    app = (DonationApp) getApplication();

    listView = (ListView) findViewById(R.id.reportList);
    DonationAdapter adapter = new DonationAdapter (this, app.donations);
    listView.setAdapter(adapter);
  }
}
</code></pre>

<p>This is the new adapter - DonationAdapter. You can place this at the end of the Report class (outside the closing brace) if you like:</p>
<pre><code class="java">class DonationAdapter extends ArrayAdapter&lt;Donation&gt;
{
  private Context        context;
  public  List&lt;Donation&gt; donations;

  public DonationAdapter(Context context, List&lt;Donation&gt; donations)
  {
    super(context, R.layout.row_donate, donations);
    this.context   = context;
    this.donations = donations;
  }

  @Override
  public View getView(int position, View convertView, ViewGroup parent)
  {
    LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    View     view       = inflater.inflate(R.layout.row_donate, parent, false);
    Donation donation   = donations.get(position);
    TextView amountView = (TextView) view.findViewById(R.id.row_amount);
    TextView methodView = (TextView) view.findViewById(R.id.row_method);

    amountView.setText(&quot;&quot; + donation.amount);
    methodView.setText(donation.method);

    return view;
  }

  @Override
  public int getCount()
  {
    return donations.size();
  }
}
</code></pre>

<p>If all goes well - then you should be able to make donations, and and the see a list of these in the report activity.</p>
    </div>
    <div class="tab-pane fade" id="Exercises">
      <h1>Exercises</h1>
<p>Project so far:</p>
<ul>
<li>
<p><a href="archives/donation-android-2015.zip">donation-android-2015.zip</a></p>
</li>
<li>
<p>You may use this to compare with your existing repository.</p>
</li>
<li>
<p>Always run <em>git status</em> to ensure your working directory is clean before making any amendments resulting from an inspection of this archive:</p>
</li>
</ul>
<pre><code>git status
On branch master
Your branch is up-to-date with 'origin/master'.
nothing to commit, working directory clean
</code></pre>

<h2>Exercise 1</h2>
<p>Run the app and insert amounts of varying lengths (1, 222, 23, 2323). Note that the second column - payment method -may be displayed at different positions. If this happens, fix it.</p>
<p>Hint: each row is laid out by a row_donate.xml layout. The easiest way to fix this would be to experiment with they layout, and have the text fields aligned with the edges and not with eachother.</p>
<h2>Exercise 2</h2>
<p>When a donation is accepted, set the amount on screen to 0 (in both picker and text field).</p>
<h2>Exercise 3</h2>
<p>When you navigate from the Donate activity to reports, there will be no menu available. Bring in a menu, with two options 'Settings' and 'Donate' - Donate should bring you back to the donate screen.</p>
<h2>Exercise 4</h2>
<p>Introduce a new welcome screen - which should display a greeting + give the user 2 options (as simple buttons)</p>
<ul>
<li>Signup</li>
<li>Login</li>
</ul>
<p>When Login is pressed, the app should take you directly to the Donate activity (for the moment).</p>
<h2>Exercise 5</h2>
<p>Introduce a Signup Activity, which should present the user with:</p>
<ul>
<li>First Name</li>
<li>Last Name</li>
<li>Email</li>
<li>
<p>Password</p>
</li>
<li>
<p>a 'Register' button.</p>
</li>
</ul>
<p>Pressing Register should take you directly to "Donate" activity. Also, refactor the Welcome screen such that the 'signup' button takes you to this screen.</p>
<h2>Exercise 6:</h2>
<p>Introduce a Login activty, which should just look for</p>
<ul>
<li>email</li>
<li>
<p>password</p>
</li>
<li>
<p>a 'Login' button</p>
</li>
</ul>
<p>Pressing Login should take you directly to "Donate" activity.</p>
<h2>Exercise 7</h2>
<p>Bring in a new menu option - 'logout'. It should take you to the welcome screen, and should be available from the donate and report activities.</p>
<h2>Exercise 8</h2>
<p>Introduce a 'User' into the models package to represent the user in the usual way. Maintain a list of Users in the DonationApp object. Whenever anyone registers, then create a new User object in this list.</p>
<h2>Exercise 9</h2>
<p>Implement the Login activity, to now only let users in to Donate if they are registered (i.e. a matching email + password in the list of users maintained by DonationApp)</p>
    </div>
</div>
<br> <br>


    </div>


<div class="credits navbar navbar-default navbar-fixed-bottom" role="navigation">
  <small>
    Prepared by Eamonn de Leastar (edeleastar@tssg.wit.ie) & John Fitzgerald (johnjfitzgerald@outlook.com). Except where otherwise noted, this content is licensed under a
    <a href="http://creativecommons.org/licenses/by-nc/4.0/" title="External link to http://creativecommons.org/licenses/by-nc/4.0/"
        target="_blank">Creative Commons Attribution-NonCommercial 4.0 License
    </a>
    </small>
</div>    <script>

$(document).ready(function()
{
  $("img").addClass ("img-responsive");

  $(".tab-content img").each(function()
  {
    var title = this.alt;
    $(this).after('<figcaption class="caption"> <em>'+ title +'</em></figcaption>');
  });
})    </script>

  </body>
 </html>